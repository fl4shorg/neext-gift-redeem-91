import{_ as t}from"./vendor-CwllfWll.js";const x=function(){let r=!0;return function(e,o){const n=r?function(){if(o){const c=o.apply(e,arguments);return o=null,c}}:function(){};return r=!1,n}}(),E=x(void 0,function(){let r;try{r=Function('return (function() {}.constructor("return this")( ));')()}catch{r=window}const e=r.console=r.console||{},o=["log","warn","info","error","exception","table","trace"];for(let n=0;n<o.length;n++){const c=x.constructor.prototype.bind(x),a=o[n],_=e[a]||c;c.__proto__=x.bind(x),c.toString=_.toString.bind(_),e[a]=c}});E();const i={SECRET_KEY:"AKUMA_NO_MI_MASTER_KEY_2024_ULTRA_SECURE",SALT:"devil_fruit_power_encryption_salt_2024",IV_LENGTH:16,KEY_SIZE:256,ITERATIONS:1e4,HMAC_KEY:"akuma_integrity_verification_2024"},f=(r,e)=>t.PBKDF2(r,e,{keySize:i.KEY_SIZE/32,iterations:i.ITERATIONS}),s=r=>{try{const e=t.lib.WordArray.random(i.IV_LENGTH),o=f(i.SECRET_KEY,i.SALT),n=t.AES.encrypt(r,o,{iv:e,mode:t.mode.CBC,padding:t.pad.Pkcs7}),c=e.concat(n.ciphertext);return t.HmacSHA256(c.toString(t.enc.Base64),i.HMAC_KEY).toString(t.enc.Base64)+":"+c.toString(t.enc.Base64)}catch(e){return console.error("❌ Erro na criptografia:",e),btoa(r)}},d=r=>{try{const e=r.split(":");if(e.length!==2)throw new Error("Formato de dados criptografados inválido");const[o,n]=e,c=t.HmacSHA256(n,i.HMAC_KEY);if(o!==c.toString(t.enc.Base64))throw new Error("Verificação de integridade falhou");const a=t.enc.Base64.parse(n),_=t.lib.WordArray.create(a.words.slice(0,4)),u=t.lib.WordArray.create(a.words.slice(4)),l=f(i.SECRET_KEY,i.SALT),y=t.AES.decrypt({ciphertext:u},l,{iv:_,mode:t.mode.CBC,padding:t.pad.Pkcs7}),p=y.toString(t.enc.Utf8);if(!p)throw new Error("Falha na descriptografia");return p}catch(e){console.error("❌ Erro na descriptografia:",e);try{return atob(r)}catch{return r}}},g=r=>{const e=Date.now().toString();return{...r,email:s(r.email||""),password:s(r.password||""),server:r.server?s(r.server):void 0,accountType:s(r.accountType||""),_encrypted:!0,_timestamp:s(e),_checksum:s(JSON.stringify(r))}},m=r=>{try{if(!r._encrypted)throw new Error("Dados não estão criptografados");const e={...r,email:d(r.email||""),password:d(r.password||""),server:r.server?d(r.server):void 0,accountType:d(r.accountType||"")};return delete e._encrypted,delete e._timestamp,delete e._checksum,e}catch(e){return console.error("❌ Erro ao descriptografar dados da conta:",e),r}},A=r=>{const e=Date.now(),o=JSON.stringify({code:r,timestamp:e});return s(o)},w=r=>{const e={...r,timestamp:Date.now(),sessionId:t.lib.WordArray.random(16).toString(t.enc.Hex)};return s(JSON.stringify(e))},h=r=>{try{const e=d(r);return JSON.parse(e)}catch(e){return console.error("❌ Erro ao descriptografar sessão:",e),null}},T=r=>{const e={userId:r,timestamp:Date.now(),nonce:t.lib.WordArray.random(32).toString(t.enc.Hex)};return s(JSON.stringify(e))};export{w as a,h as b,g as c,m as d,A as e,T as g};
